<UserControl x:Class="NexusFinance.Views.AnalyticsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:local="clr-namespace:NexusFinance.Views"
             Background="#050505">

    <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="40">
        <StackPanel>
            
            <!-- HEADER -->
            <Grid Margin="0,0,0,30">
                <TextBlock Text="ðŸ“Š Advanced Analytics" 
                          FontSize="32" 
                          FontWeight="Bold" 
                          Foreground="#E0E0E0"/>
                <Button Content="ðŸ”„ Refresh" 
                       Command="{Binding RefreshCommand}"
                       HorizontalAlignment="Right"
                       Foreground="Black"
                       BorderBrush="#808080"
                       BorderThickness="1"
                       Padding="15,8"
                       FontSize="12"
                       FontWeight="Bold"
                       Cursor="Hand">
                    <Button.Style>
                        <Style TargetType="Button">
                            <Setter Property="Background">
                                <Setter.Value>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                        <GradientStop Color="#E0E0E0" Offset="0"/>
                                        <GradientStop Color="#C0C0C0" Offset="1"/>
                                    </LinearGradientBrush>
                                </Setter.Value>
                            </Setter>
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="Button">
                                        <Border Background="{TemplateBinding Background}" 
                                               BorderBrush="{TemplateBinding BorderBrush}"
                                               BorderThickness="{TemplateBinding BorderThickness}"
                                               CornerRadius="6" 
                                               Padding="{TemplateBinding Padding}">
                                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                        </Border>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </Button.Style>
                </Button>
            </Grid>

            <!-- SANKEY DIAGRAM -->
            <local:SankeyControl SankeyData="{Binding SankeyData}" 
                               Margin="0,0,0,30"/>

            <!-- CORRELATION MATRIX -->
            <Border Background="#CC252526" 
                   CornerRadius="12" 
                   Padding="20"
                   BorderBrush="#505050" 
                   BorderThickness="1">
                <Border.Effect>
                    <DropShadowEffect Color="Black" ShadowDepth="4" BlurRadius="10" Opacity="0.5"/>
                </Border.Effect>
                
                <StackPanel>
                    
                    <!-- MATRIX HEADER -->
                    <TextBlock Text="ðŸ”— Asset Correlation Matrix" 
                              FontSize="20" 
                              FontWeight="SemiBold" 
                              Foreground="#E0E0E0" 
                              Margin="0,0,0,10"/>
                    
                    <TextBlock Text="Shows how different assets move together. Strong correlation = risky diversification. Negative correlation = good hedge." 
                              FontSize="12" 
                              Foreground="#808080" 
                              TextWrapping="Wrap"
                              Margin="0,0,0,20"/>

                    <!-- CORRELATION GRID -->
                    <Grid x:Name="CorrelationGrid">
                        <Grid.Resources>
                            <!-- Cell style -->
                            <Style x:Key="CorrelationCellStyle" TargetType="Border">
                                <Setter Property="BorderBrush" Value="#404040"/>
                                <Setter Property="BorderThickness" Value="1"/>
                                <Setter Property="Margin" Value="1"/>
                                <Setter Property="CornerRadius" Value="2"/>
                            </Style>
                            
                            <Style x:Key="CellTextStyle" TargetType="TextBlock">
                                <Setter Property="Foreground" Value="#E0E0E0"/>
                                <Setter Property="FontSize" Value="11"/>
                                <Setter Property="FontWeight" Value="SemiBold"/>
                                <Setter Property="HorizontalAlignment" Value="Center"/>
                                <Setter Property="VerticalAlignment" Value="Center"/>
                            </Style>
                        </Grid.Resources>
                        
                        <!-- Dynamic grid will be populated in code-behind -->
                    </Grid>
                    
                    <!-- LEGEND -->
                    <Grid Margin="0,20,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <StackPanel Grid.Column="0" Orientation="Horizontal" Margin="0,0,30,0">
                            <Border Width="16" Height="16" Background="#808080" CornerRadius="2" Margin="0,0,8,0"/>
                            <TextBlock Text="High Positive (>0.7)" Foreground="#808080" FontSize="11"/>
                        </StackPanel>
                        
                        <StackPanel Grid.Column="1" Orientation="Horizontal" Margin="0,0,30,0">
                            <Border Width="16" Height="16" Background="#505050" CornerRadius="2" Margin="0,0,8,0"/>
                            <TextBlock Text="Moderate (0.4-0.7)" Foreground="#808080" FontSize="11"/>
                        </StackPanel>
                        
                        <StackPanel Grid.Column="2" Orientation="Horizontal" Margin="0,0,30,0">
                            <Border Width="16" Height="16" Background="#303030" CornerRadius="2" Margin="0,0,8,0"/>
                            <TextBlock Text="Negative (&lt;-0.7)" Foreground="#808080" FontSize="11"/>
                        </StackPanel>
                        
                        <StackPanel Grid.Column="3" Orientation="Horizontal">
                            <Border Width="16" Height="16" Background="#1E1E1E" CornerRadius="2" Margin="0,0,8,0"/>
                            <TextBlock Text="Low (&lt;0.4)" Foreground="#808080" FontSize="11"/>
                        </StackPanel>
                    </Grid>
                    
                </StackPanel>
            </Border>

        </StackPanel>
    </ScrollViewer>
</UserControl>
