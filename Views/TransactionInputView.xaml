<UserControl x:Class="NexusFinance.Views.TransactionInputView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:loc="clr-namespace:NexusFinance.Services"
             Background="#050505">
    
    <UserControl.Resources>
        <!-- GLASS PANEL STYLE -->
        <Style x:Key="GlassPanelStyle" TargetType="Border">
            <Setter Property="Background" Value="#CC181818"/>
            <Setter Property="BorderBrush" Value="#33FFFFFF"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="Black" ShadowDepth="0" BlurRadius="15" Opacity="0.4"/>
                </Setter.Value>
            </Setter>
        </Style>
        
        <!-- SECTION LABEL STYLE -->
        <Style x:Key="SectionLabelStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="10"/>
            <Setter Property="Foreground" Value="#707070"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Margin" Value="0,0,0,8"/>
        </Style>
        
        <!-- INPUT BOX STYLE -->
        <Style x:Key="StealthInputStyle" TargetType="TextBox">
            <Setter Property="Background" Value="#0CFFFFFF"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderBrush" Value="#404040"/>
            <Setter Property="BorderThickness" Value="0,0,0,1"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="CaretBrush" Value="#E0E0E0"/>
        </Style>
    </UserControl.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        
        <Border Style="{StaticResource GlassPanelStyle}" 
               MaxWidth="700" 
               MaxHeight="500"
               VerticalAlignment="Center"
               HorizontalAlignment="Center"
               Padding="30">
            
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/> <!-- Header -->
                    <RowDefinition Height="Auto"/> <!-- Smart Command Bar -->
                    <RowDefinition Height="*"/>    <!-- Main Form Grid -->
                    <RowDefinition Height="Auto"/> <!-- Footer Actions -->
                </Grid.RowDefinitions>
                
                <!-- HEADER -->
                <TextBlock Grid.Row="0" 
                          FontSize="22" 
                          FontWeight="Bold" 
                          Foreground="#E0E0E0" 
                          Margin="0,0,0,20">
                    <Run Text="âš¡ "/>
                    <Run Text="{loc:Translate Key=Transaction_Title}"/>
                </TextBlock>
                
                <!-- SMART COMMAND BAR -->
                <Border Grid.Row="1" 
                       Background="#20FFFFFF" 
                       CornerRadius="8" 
                       Padding="15"
                       Margin="0,0,0,25"
                       BorderBrush="#404040"
                       BorderThickness="1">
                    <Grid>
                        <TextBox x:Name="SmartInputBox"
                                Background="Transparent"
                                Foreground="#C0C0C0"
                                BorderThickness="0"
                                FontSize="13"
                                FontFamily="Consolas"
                                Text="Magic Input: '12500 AWS Server #NexusAI' (Future feature)"
                                IsEnabled="False"/>
                        <TextBlock Text="ðŸª„" 
                                  FontSize="16" 
                                  HorizontalAlignment="Right" 
                                  VerticalAlignment="Center"
                                  Margin="0,0,5,0"
                                  Opacity="0.3"/>
                    </Grid>
                </Border>
                
                <!-- MAIN FORM GRID -->
                <Grid Grid.Row="2">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2*"/> <!-- Left: Hard Data -->
                        <ColumnDefinition Width="20"/>
                        <ColumnDefinition Width="3*"/> <!-- Right: Context -->
                    </Grid.ColumnDefinitions>
                    
                    <!-- LEFT COLUMN: HARD DATA -->
                    <StackPanel Grid.Column="0">
                        
                        <!-- TRANSACTION TYPE -->
                        <TextBlock Text="{loc:Translate Key=Transaction_Type}" Style="{StaticResource SectionLabelStyle}"/>
                        <Grid Margin="0,0,0,20">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="5"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <RadioButton Grid.Column="0"
                                        x:Name="IncomeRadio"
                                        Content="{loc:Translate Key=Transaction_Income}"
                                        GroupName="TransactionType"
                                        Foreground="#00C853"
                                        FontSize="12"
                                        FontWeight="SemiBold"
                                        Padding="12,10"
                                        HorizontalContentAlignment="Center"
                                        IsChecked="{Binding IsIncome}">
                                <RadioButton.Style>
                                    <Style TargetType="RadioButton">
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="RadioButton">
                                                    <Border Background="#0A000000" 
                                                           BorderBrush="#404040"
                                                           BorderThickness="1"
                                                           CornerRadius="6"
                                                           Padding="{TemplateBinding Padding}">
                                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                        <Border.Style>
                                                            <Style TargetType="Border">
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding IsChecked, RelativeSource={RelativeSource TemplatedParent}}" Value="True">
                                                                        <Setter Property="Background" Value="#1A00C853"/>
                                                                        <Setter Property="BorderBrush" Value="#00C853"/>
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </Border.Style>
                                                    </Border>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </RadioButton.Style>
                            </RadioButton>
                            
                            <RadioButton Grid.Column="2"
                                        x:Name="ExpenseRadio"
                                        Content="{loc:Translate Key=Transaction_Expense}"
                                        GroupName="TransactionType"
                                        Foreground="#D50000"
                                        FontSize="12"
                                        FontWeight="SemiBold"
                                        Padding="12,10"
                                        HorizontalContentAlignment="Center">
                                <RadioButton.Style>
                                    <Style TargetType="RadioButton">
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="RadioButton">
                                                    <Border Background="#0A000000" 
                                                           BorderBrush="#404040"
                                                           BorderThickness="1"
                                                           CornerRadius="6"
                                                           Padding="{TemplateBinding Padding}">
                                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                        <Border.Style>
                                                            <Style TargetType="Border">
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding IsChecked, RelativeSource={RelativeSource TemplatedParent}}" Value="True">
                                                                        <Setter Property="Background" Value="#1AD50000"/>
                                                                        <Setter Property="BorderBrush" Value="#D50000"/>
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </Border.Style>
                                                    </Border>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </RadioButton.Style>
                            </RadioButton>
                        </Grid>
                        
                        <!-- AMOUNT (BIG) -->
                        <TextBlock Text="{loc:Translate Key=Transaction_Amount}" Style="{StaticResource SectionLabelStyle}"/>
                        <Border Background="#0CFFFFFF" 
                               CornerRadius="8" 
                               Padding="20,15"
                               Margin="0,0,0,20"
                               BorderBrush="#505050"
                               BorderThickness="1">
                            <Grid>
                                <TextBlock Text="â‚½" 
                                          FontSize="32" 
                                          Foreground="#606060"
                                          VerticalAlignment="Center"
                                          Margin="0,0,10,0"/>
                                <TextBox x:Name="AmountBox"
                                        Text="{Binding Amount, UpdateSourceTrigger=PropertyChanged}"
                                        Background="Transparent"
                                        Foreground="#E0E0E0"
                                        BorderThickness="0"
                                        FontSize="36"
                                        FontWeight="Bold"
                                        Padding="30,0,0,0"
                                        VerticalContentAlignment="Center"
                                        CaretBrush="White"/>
                            </Grid>
                        </Border>
                        
                        <!-- DATE -->
                        <TextBlock Text="{loc:Translate Key=Transaction_Date}" Style="{StaticResource SectionLabelStyle}"/>
                        <DatePicker x:Name="DateBox"
                                   SelectedDate="{Binding SelectedDate}"
                                   Background="#0CFFFFFF"
                                   Foreground="White"
                                   BorderBrush="#404040"
                                   BorderThickness="1"
                                   Padding="12,10"
                                   FontSize="13"
                                   Margin="0,0,0,20"/>
                        
                        <!-- FLAGS -->
                        <StackPanel Margin="0,10,0,0">
                            <CheckBox Content="ðŸ”„ Recurring Transaction"
                                     Foreground="#808080"
                                     FontSize="11"
                                     Margin="0,0,0,8"
                                     IsEnabled="False"
                                     Opacity="0.5"/>
                            <CheckBox Content="âœ… Cleared (Posted)"
                                     Foreground="#808080"
                                     FontSize="11"
                                     IsEnabled="False"
                                     Opacity="0.5"/>
                        </StackPanel>
                    </StackPanel>
                    
                    <!-- RIGHT COLUMN: CONTEXT -->
                    <StackPanel Grid.Column="2">
                        
                        <!-- PROJECT -->
                        <TextBlock Text="{loc:Translate Key=Transaction_Project}" Style="{StaticResource SectionLabelStyle}"/>
                        <ComboBox x:Name="ProjectBox"
                                 ItemsSource="{Binding Projects}"
                                 SelectedItem="{Binding SelectedProject}"
                                 IsEditable="True"
                                 Background="#0CFFFFFF"
                                 Foreground="White"
                                 BorderBrush="#404040"
                                 BorderThickness="1"
                                 Padding="12,10"
                                 FontSize="13"
                                 Margin="0,0,0,20"/>
                        
                        <!-- CATEGORY -->
                        <TextBlock Text="{loc:Translate Key=Transaction_Category}" Style="{StaticResource SectionLabelStyle}"/>
                        <ComboBox x:Name="CategoryBox"
                                 ItemsSource="{Binding Categories}"
                                 SelectedItem="{Binding SelectedCategory}"
                                 IsEditable="True"
                                 Background="#0CFFFFFF"
                                 Foreground="White"
                                 BorderBrush="#404040"
                                 BorderThickness="1"
                                 Padding="12,10"
                                 FontSize="13"
                                 Margin="0,0,0,20"/>
                        
                        <!-- DESCRIPTION -->
                        <TextBlock Text="{loc:Translate Key=Transaction_Description}" Style="{StaticResource SectionLabelStyle}"/>
                        <TextBox x:Name="DescriptionBox"
                                Text="{Binding Description, UpdateSourceTrigger=PropertyChanged}"
                                Background="#0CFFFFFF"
                                Foreground="White"
                                BorderBrush="#404040"
                                BorderThickness="1"
                                Padding="12,10"
                                FontSize="13"
                                Height="80"
                                TextWrapping="Wrap"
                                AcceptsReturn="True"
                                VerticalScrollBarVisibility="Auto"
                                Margin="0,0,0,20"
                                CaretBrush="White"/>
                        
                        <!-- TAGS (Future Feature) -->
                        <TextBlock Text="{loc:Translate Key=Transaction_Tags}" Style="{StaticResource SectionLabelStyle}"/>
                        <TextBox x:Name="TagsBox"
                                Background="#0CFFFFFF"
                                Foreground="#808080"
                                BorderBrush="#404040"
                                BorderThickness="1"
                                Padding="12,10"
                                FontSize="12"
                                Text="#tag1, #tag2"
                                IsEnabled="False"
                                Opacity="0.5"
                                CaretBrush="White"/>
                    </StackPanel>
                </Grid>
                
                <!-- FOOTER ACTIONS -->
                <Grid Grid.Row="3" Margin="0,25,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="15"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <!-- CANCEL (Text Only) -->
                    <Button Grid.Column="0"
                           Content="{loc:Translate Key=Btn_Cancel}" 
                           Command="{Binding CancelCommand}"
                           Background="Transparent"
                           Foreground="#808080"
                           BorderThickness="0"
                           FontSize="12"
                           Padding="15,10"
                           Cursor="Hand">
                        <Button.Style>
                            <Style TargetType="Button">
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                            <Border Background="{TemplateBinding Background}" 
                                                   Padding="{TemplateBinding Padding}">
                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Foreground" Value="#C0C0C0"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>
                    
                    <!-- SAVE & NEW (Outline) -->
                    <Button Grid.Column="2"
                           Content="{loc:Translate Key=Btn_SaveNew}" 
                           Background="Transparent"
                           Foreground="#C0C0C0"
                           BorderBrush="#808080"
                           BorderThickness="1"
                           Padding="20,10"
                           FontSize="12"
                           FontWeight="SemiBold"
                           Cursor="Hand"
                           IsEnabled="False"
                           Opacity="0.5">
                        <Button.Template>
                            <ControlTemplate TargetType="Button">
                                <Border Background="{TemplateBinding Background}" 
                                       BorderBrush="{TemplateBinding BorderBrush}"
                                       BorderThickness="{TemplateBinding BorderThickness}"
                                       CornerRadius="6" 
                                       Padding="{TemplateBinding Padding}">
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                            </ControlTemplate>
                        </Button.Template>
                    </Button>
                    
                    <!-- EXECUTE (Primary Action) -->
                    <Button Grid.Column="4"
                           Command="{Binding AddTransactionCommand}"
                           Foreground="Black"
                           BorderBrush="#808080"
                           BorderThickness="1"
                           Padding="35,12"
                           FontSize="14"
                           FontWeight="Bold"
                           Cursor="Hand">
                        <Button.Content>
                            <TextBlock>
                                <Run Text="âš¡ "/>
                                <Run Text="{loc:Translate Key=Btn_Execute}"/>
                            </TextBlock>
                        </Button.Content>
                        <Button.Style>
                            <Style TargetType="Button">
                                <Setter Property="Background">
                                    <Setter.Value>
                                        <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                            <GradientStop Color="#E0E0E0" Offset="0"/>
                                            <GradientStop Color="#C0C0C0" Offset="1"/>
                                        </LinearGradientBrush>
                                    </Setter.Value>
                                </Setter>
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="Button">
                                            <Border Background="{TemplateBinding Background}" 
                                                   BorderBrush="{TemplateBinding BorderBrush}"
                                                   BorderThickness="{TemplateBinding BorderThickness}"
                                                   CornerRadius="6" 
                                                   Padding="{TemplateBinding Padding}">
                                                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                <Border.Effect>
                                                    <DropShadowEffect Color="White" ShadowDepth="0" BlurRadius="10" Opacity="0"/>
                                                </Border.Effect>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background">
                                            <Setter.Value>
                                                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                                    <GradientStop Color="#FFFFFF" Offset="0"/>
                                                    <GradientStop Color="#E0E0E0" Offset="1"/>
                                                </LinearGradientBrush>
                                            </Setter.Value>
                                        </Setter>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>
                </Grid>
                
            </Grid>
        </Border>
    </Grid>
</UserControl>
